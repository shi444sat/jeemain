<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css"
        />
        <style>
  /* Styling for the modal */
  .modal {
    display: none; /* Hidden by default */
    position: fixed; /* Stay in place */
    z-index: 1; /* Sit on top */
    left: 0;
    top: 0;
    width: 100%; /* Full width */
    height: 100%; /* Full height */
    overflow: auto; /* Enable scroll if needed */
    background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
  }
  
  /* Modal content */
  .modal-content {
    background-color: #fefefe;
    margin: 15% auto; /* 15% from the top and centered */
    padding: 20px;
    border: 1px solid #888;
    width: 80%; /* Could be more or less, depending on screen size */
  }
  
  /* Close button */
  .close {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
  }
  
  .close:hover,
  .close:focus {
    color: black;
    text-decoration: none;
    cursor: pointer;
  }
</style>
        <title>JEE Scorecard Generator</title>
<script data-goatcounter="https://jeemainresult.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>
        <script defer src="./modal.js"></script>
        <script defer src="./app.js"></script>
        <style>
            li {
                margin-top: 2rem;
            }
            textarea,
            select {
                margin-top: 1rem;
            }
            dialog article {
                width: 80ch;
            }
            .shift span,
            .score span {
                font-weight: bold;
            }
        </style>
    </head>
    <body>
        <div id="myModal" class="modal">
  <!-- Modal content -->
  <div class="modal-content">
    <span class="close">&times;</span>
    <p>Real owner of this chad website <b>Gyani</b> and <b>Shiv</b></p>
    <p>we created this website just for fun and to relief the student pressure of JEE hope you enjoyed it.</p>
    <p>*This website does not store any user input data.</p>
    <button id="modalButton">Visit our site</button>
  </div>
</div>

<script>
// Get the modal
var modal = document.getElementById("myModal");

// Get the <span> element that closes the modal
var span = document.getElementsByClassName("close")[0];

// When the page is fully loaded, show the modal
window.onload = function() {
  modal.style.display = "block";
}

// When the user clicks on <span> (x), close the modal
span.onclick = function() {
  modal.style.display = "none";
}

// When the user clicks anywhere outside of the modal, close it
window.onclick = function(event) {
  if (event.target == modal) {
    modal.style.display = "none";
  }
}

document.getElementById("modalButton").addEventListener("click", function() {
  // Redirect to another site
  window.location.href = "https://shivagyaworld.blogspot.com/"; 
});
</script>
        <main class="container">
            <h1>JEE Scorecard Generator</h1>
            <form id="main-form">
                <ul>
                    <li>
                        <strong>Step 1:</strong> Select your shift
                        <select id="shift" name="shift" required>
                            <option value="27s1">
                                27 Jan 2024 Shift 1 (thx u/Responsible-You2347)
                            </option>
                            <option value="27s2">
                                27 Jan 2024 Shift 2 (by yours truly)
                            </option>
                            <option value="29s1">
                                29 Jan 2024 Shift 1 (thx u/Brave-Economist-7005)
                            </option>
                            <option value="29s2">
                                29 Jan 2024 Shift 2 (thx u/TitaniumDEVIL)
                            </option>
                            <option value="30s1">
                                30 Jan 2024 Shift 1 <em>(thx u/Mystic1869)</em>
                            </option>
                            <option value="30s2">
                                30 Jan 2024 Shift 2
                                <em>(thx u/deceptivesiteahead)</em>
                            </option>
                            <option value="31s1">
                                31 Jan 2024 Shift 1
                                <em>(thx u/potter_k)</em>
                            </option>
                            <option value="01s1">
                                01 Feb 2024 Shift 1 (thx u/YashvardanVkr)
                            </option>

                            <option value="01s2">
                                (FIXED) 01 Feb 2024 Shift 2 (thx u/VicFic18)
                            </option>
                        </select>
                    </li>
                    <li>
                        <strong>Step 2:</strong>
                        <ul>
                            <li>
                                Copy this script
                                <br /><br />
                                <button
                                    class="secondary"
                                    onclick="copyScript()"
                                    type="button"
                                >
                                    Copy script
                                </button>
                                <a
                                    href="./scraper.js"
                                    >(Copy from this page if the button is not
                                    working)</a
                                >
                            </li>
                            <li>Open your response sheet page</li>
                            <li>
                                Open Developer Tools (Right-click > Inspect)
                            </li>
                            <li>Go to the Console tab</li>
                            <li>
                                Paste and hit enter (If you see a warning, type
                                <code>allow pasting</code> and hit enter first,
                                and then paste the script)
                            </li>
                            <li>
                                Copy the output
                                <br />
                                (Firefox: Right-click > Copy Object)
                                <br />
                                (Chrome etc: Hover over the output and click on
                                "Copy")
                            </li>
                        </ul>
                        <br />

                        <br />
                        <textarea
                            id="scriptarea"
                            style="
                                opacity: 0;
                                height: 0;
                                width: 0;
                                position: fixed;
                                bottom: 0;
                            "
                            cols="1"
                            rows="1"
                        >
const tables = document.querySelectorAll(".menu-tbl");
const data = {};

tables.forEach((table, i) => {
    const qnType = table.querySelectorAll("tr td.bold")[0].innerText.trim(); // "MCQ || "SA"
    const qnID = table.querySelectorAll("tr td.bold")[1].innerText.trim();

    if (qnType === "MCQ") {
        let hasAnswered = false;
        const status2 = table
            .querySelectorAll("tr td.bold")[6]
            .innerText.trim();
        if (status2 === "Answered" || status2 === "Marked For Review") {
            hasAnswered = true;
        }

        if (hasAnswered) {
            let options = [0, 0, 0, 0];
            for (let j = 0; j < 4; j++) {
                options[j] = Number(
                    table.querySelectorAll("tr td.bold")[2 + j].innerText
                );
            }

            const ownAnswerIndex =
                Number(
                    table.querySelectorAll("tr td.bold")[7].innerText.trim()
                ) - 1;
            const ownAnswerID = options[ownAnswerIndex];

            options.sort(); // doing the stuff NTA should've done

            const ownAnswer = options.indexOf(ownAnswerID) + 1;

            data[qnID] = {
                qnType,
                hasAnswered,
                options,
                ownAnswer,
                ownAnswerID,
            };
        } else {
            data[qnID] = { qnType, hasAnswered };
        }
    } else if (qnType === "SA") {
        let hasAnswered = false;
        const status = table.querySelectorAll("tr td.bold")[2].innerText.trim();

        if (status === "Answered" || status === "Marked For Review") {
            hasAnswered = true;
        }

        if (hasAnswered) {
            const ownAnswer = document
                .querySelectorAll(".questionRowTbl")
                [i].querySelector("tr:nth-of-type(5) td.bold").innerText; // very ugly query, ik

            data[qnID] = {
                qnType,
                hasAnswered,
                ownAnswer,
            };
        } else {
            data[qnID] = { qnType, hasAnswered };
        }
    }
});

const generatedJSON = JSON.stringify(data, null, 2);
console.log(generatedJSON);
                
                </textarea
                        >
                    </li>
                    <li>
                        <strong>Step 3:</strong> Paste the output from the
                        script here:
                        <br />
                        <textarea
                            required
                            name="responses"
                            id="responses"
                            Submit
                            cols="80"
                            rows="10"
                            placeholder="Paste output here..."
                        ></textarea>
                    </li>
                    <li>
                        <strong>Step 4:</strong> You're done!
                        <br />
                        <br />
                        <button
                            type="submit"
                            data-target="modal-example"
                            onclick="toggleModal(event)"
                        >
                            Get scorecard
                        </button>
                    </li>
                </ul>
                <p>
                    Disclaimer: This program and the answer key json files may
                    contain bugs, so don't take your scores
                    <em>too</em> seriously. Wait for NTA's result!
                </p>
            </form>

            <!-- Modal -->
            <dialog id="modal-example">
                <article>
                    <a
                        href="#close"
                        aria-label="Close"
                        class="close"
                        data-target="modal-example"
                        onClick="toggleModal(event)"
                    >
                    </a>
                    <h3>Your JEE score</h3>
                    <div id="result">
                        <p class="shift">Shift: <span></span></p>
                        <p class="score">Your score: <span></span></p>
                        <h4>Question stats:</h4>
                        <table>
                            <tbody>
                                <tr>
                                    <td>Attempted</td>
                                    <td class="attempted"></td>
                                </tr>
                                <tr>
                                    <td>Correct</td>
                                    <td class="correct"></td>
                                </tr>
                                <tr>
                                    <td>Incorrect</td>
                                    <td class="incorrect"></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <footer>
                        <a
                            href="#confirm"
                            role="button"
                            data-target="modal-example"
                            onClick="toggleModal(event)"
                        >
                            Done
                        </a>
                    </footer>
                </article>
            </dialog>
        </main>
        <footer style="text-align: center">
            Scorecard Generator Credit <a href="https://github.com/nikhilmwarrier/">nik</a>
        </footer>
    </body>
</html>
